# Информация о собираемых метриках

| Пункт мониторинга | bpftrace-скрипт| Собираемые данные | Установление связей |
| :---: | --- | --- | --- |
| Сокеты | `socket.bt` | - тип syscall (accept/connect) <br>- протокол (UNIX, INET, INET6) <br>- полный путь исполняемого файла <br>- файловый дескриптор сокета | Определение взаимодействующих процессов будет производится на основе соотношения типа syscall (accept|connect) и файлового дескриптора сокета. |
| Именованные каналы (SystemV/Posix) | `namedpipes.bt` | - полный путь исполняемого файла <br>- файловый дескриптор канала <br>- имя канала | Взаимодейтсиве определяется двумя способами: <br>1. Соотнести по имени канала в результирующем файле текущего скрипта. <br>2. Соотнести полный путь исполняемого файла с файлом в который он пишнт/читает по результатам работы скрипта `fsorw.bt`. |
| Семафоры (SystemV) | `semaphores.bt` | - полный путь исполняемого файла <br>- id семафорв | Здесь взаимодейтсиве определяется не между файлами, а различних файлов с одном и тем же семафором, сделать это возможно через соотношение одинаклвых id и полных путей фалов.|
| Общая память (SystemV/Posix) | `sharedMem.bt` | - полный путь исполняемого файла <br>- id участка шареной памяти <br>- тип (SystemV/Posix) | Аналогично предыдущему варианту, рассматривается взаимодействие "одного ко многим". |
| Чтение/запись одного файла в другой | `fsorw.bt` | - полный путь исполняемого файла <br>- файловый дескриптор открываемого им файла <br>- полный путь к открываемому файлу <br>- кол-во считанных байт <br>- кол-во записанных байт | Результат работы этого скрипта может быть использован для установление взаимосвязи между процессами. |

> Полный путь исполняемого файла выводит в обратном порядке (начиная с имени файла и далее к корневой дирректории), а так же ограничевается глубиной вложенности в 1000.

### Пункты мониторинга, которые нет возможности собирать:
   - Неименнованные канал (из-за специфики системного вызова не может получить fd канала, для дальнейшей фильтрации других системных вызовов по нему)
   - Семафоры (Posix) (bpftrace не поддерживает ни один тип зондов для данного типа ipc)
