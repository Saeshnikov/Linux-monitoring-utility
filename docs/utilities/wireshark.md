# Отчёт по утилите Wireshark

Wireshark позволяет захватывать пакеты из различных источников, таких как Ethernet, Wirelessm LAN, Bluetooth, USB

### Функционал
- Захват сетевых пакетов в реальном времени
- Отображение содержимого пакетов
- Фильтрация пакетов с гибкой настройкой параметров
- Создание статистик
- Поиск пакетов
- Встроенный декодер для большого числа протоколов


Также, Wireshark имеет совместимость с другими утилитами захвата пакетов, например, Wireshark может читать выходные файлы утилиты TCPdump.

_Wireshark является утилитой сканирования, при том, никаких вмешательств в работу сети не производится._

### Использование в командной строке

Usage: wireshark [options] ... [ \<infile\> ]

Интерфейс захвата:
  - -i \<interface\>           имя или id интерфейса (по умол. первый без обратной связи)
  - -f /\<capture filter\>      фильтр пакетов в синтаксе libcap
  - -s \<snaplen\>             максимальная длина захваченного пакета (по умол. 65535)
  - -p                       не захватывать в смешанном режиме
  - -k                       моментально начать захват (по умол. бездействие)
  - -S                       обновлять отображение захваченных пакетов
  - -l                       включить автоматическую промотку вниз (для -S)
  - -I                       захват в режиме монитора, если доступно
  - -B \<buffer size\>         размер буфера ядра (по умол. 1MB)
  - -y \<link type\>           тип уровня связи (по умол. первый соответствующий)
  - -D                       вывести список интерфейсов и выйти
  - -L                       вывести список уровней связи интерфейсов и выйти

Условия остановки захвата:
  - -c \<packet count\>         остановка после n пакетов (по умол. бесконечнное кол-во)
  - -a \<autostop cond.\> 
    - длительность(NUM) - остановка после NUM секунд</br>
    - размер файла(NUM): \- остановиться после достижения заданного размера файла NUM килобайт</br>
    - кол-во файлов(NUM) \- остановиться после достижения заданного кол-ва файлов</br>

Вывод:
  - -b \<ringbuffer opt.\> ... duration:NUM - switch to next file after NUM secs
                           filesize:NUM - switch to next file after NUM KB
                              files:NUM - ringbuffer: replace after NUM files

Входной файл:
  - -r \<infile\>              Установить входной файл (не поддерживается | или чтение из стандартного потока)

Обработка:
  - -R \<read filter\>         packet filter in Wireshark display filter syntax
  - -n                       отключить все расширения файлов (по умол. все включены)
  - -N \<name resolve flags\>  включить специфичные разрешения имён: "mntC"

Пользовательский интерфейс:
  - -C \<config profile\>      начать с заданным конфигурационным файлом
  - -d \<display filter\>      начать с заданным фильтром
  - -g \<packet number\>       перейти к заданному после "-r" пакету
  - -J \<jump filter\>         перейти к первому совпадающему пакету (по фильтру)
  - -j                         поиск назад для совпадения пакета после "-J"
  - -m \<font\>                указать шрифт
  - -t ad|a|r|d|dd|e           формат отображения времени (.. : .. : ..)
  - -u s|hms                   формат отображения секунд
  - -X \<key\>:\<value\>       опции расширений
  - -z \<statistics\>          показывает различные статистики

Вывод:
  - -w \<outfile|-\>           имя выходного потока (или '-' для вывода в консоль)

Прочее:
  - -h                       вывести справку и выйти
  - -v                       вывести версию и выйти
  - -P \<key\>:\<path\>          файлы конфигурации
                           файлы с данными
  - -o \<name\>:\<value\> ...    перезаписать настройку
  - -K \<keytab\>              файл для использования в kerberos декодировании
  - \-\-display=DISPLAY        использовать заданный дисплей

### Типовые примеры использования

- Выяснить причину загрузки сети (по параметру tcp.time.delta можно узнать сколько времени было затрачено на отправку запроса и получения ответа от хоста)
- Увидеть поток пакетов между двумя выбранными узлами
- Провести сканирование портов

Польза от этой утилиты зависит от конкретной задачи анализирования пакетов.
Т.к. утилита имеет огромный функционал, его вид будет зависеть от практических задач, поставленных в области анализа пакетов.

### Сравнение с procfs

Сравнение с procfs невозможно, т.к. работа Wireshark основана на библиотеке libpcap, которая использует API сокета PF_PACKET.

### Практическая польза утилиты

Можно вызывать в нашей утилите мониторинга с заданными ключами, формировать выходной файл нужной структуры, подвергать дальнейшему анализу. Есть части Wireshark, которые, скорее всего, можно отбросить, к примеру прослушивание пакетов VoIP(телефонные разговоры), пакетов Bluetooth и USB.


