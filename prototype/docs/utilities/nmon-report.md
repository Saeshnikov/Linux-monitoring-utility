### Утилита nmon(Ngel’s Monitor)
Полностью интерактивная утилита командной строки, которая выполняет мониторинг производительности для операционных систем UNIX-подобных систем, таких как AIX (IBM), Linux, и других. По умолчанию мониторит локальную систему, на которой установлена, однако существуют способы использования nmon для удаленного мониторинга других устройств(например подключение к удаленному серверу через ssh. Сама программа легковесная и практически не нагружает систему. Данные выводятся на экран и обновляются каждые 2 секунды. Длину интервала между интервалами можно изменить. Так что программа предоставляет возможность сохраняться данные в текстовый файл формата csv для последующего анализа полученных данных и построение графиков.
Характеристики nmon
При запуске программы, предлагает на выбор следующие клавиши для переключения статистики
- с – CPU 
- C – CPU Utilisation Wide View
- m – memory
- d – disks
- r – resource 
- k – kernel 
- l – CPU long-term
- U – Utilisation 
- V – Virtual memory
- n – Network
- N – NFS 
- t – top-processes
- "-"	- Faster screen updates
- "+" - Slower screen updates
- j – File systems
- . – only busy disks/procs
- h – more options 
- q – Quit
Подробнее об основных
### CPU(c) 
#### Вывод в режиме записи:
- User%
- Sys% 
- Wait% 
- Idle% 
- Steal% 
#### Вывод в интерактивном режиме:
При мониторинге использования центрального процессора (CPU Utilization), параметры User%, Sys%, Wait%, и Idle представляют процентное соотношение времени, которое процессор тратит на различные виды задач, так же вывод в avg средней нагрузки в целом. Вот их значения:
- User% (Пользовательское время):
Процент времени, в течение которого процессор занят выполнением пользовательских задач. 
- Sys% (Системное время):
Процент времени, в течение которого процессор тратит на выполнение системных задач ядра операционной системы. 
- Wait% (Время ожидания):
Процент времени, в течение которого процессор ожидает завершения операций ввода-вывода (I/O). 
- Idle (Простой):
Процент времени, в течение которого процессор находится в состоянии простоя, то есть не выполняет никаких задач.
### Memory(m)
#### Вывод в режиме записи: 
- Memtotal 
Доступный объем оперативной памяти (физическая память за вычетом нескольких зарезервированных битов и бинарного кода ядра).
- Hightotal
Размер области верхней памяти. Область верхней памяти (highmem) - это вся память, выше (приблизительно) 860 МБ физической ОЗУ. Доступ к этой памяти осуществляется через косвенные механизмы доступа. Здесь может находиться кэш данных.
- Lowtotal
Общий объем памяти без highmem-памяти.
- Swaptotal
Общий физический размер свопинга.
- Memfree
Сумма LowFree и HighFree.
- Highfree
Объем свободной памяти в верхней области памяти.
- Lowfree
Объем свободной памяти в нижней области памяти. Это память, к которой ядро может обращаться напрямую. Все структуры данных ядра должны находиться этой области.
- Swapfree
Количество свободной памяти в свопинге. Swap - память, которая была выгружена из ОЗУ и временно находится на диске.
- Shmem
Дополнительная ячейка памяти для процессов с отдельными адресными пространствами. Такие процессы могут совместно использовать часть памяти.
- Cached
Память в кэше страниц за вычетом SwapCache.
- Active
Память, которая использовалась совсем недавно. Обычно не освобождается без крайней необходимости.
- Bigfree 
DEPRECATED?
- Buffers
Память в буферном кеше. В настоящее время бесполезен в качестве метрики. Это временное хранилище для страниц, ожидающих записи на диск. Не должно быть слишком большим (обычно около 20 МБ).
- Swapcached
Память, которая когда-то была выгружена в своп, но потом загружена обратно и все еще находится в файле подкачки. Если будет необходимость в выделении памяти, то эту память не нужно будет выгружать повторно, так как она уже находится в свопе. Это экономит операции ввода-вывода.
- inactive 
Память, которая использовалась в ближайшее время.
Позволяет посмотреть общее количество оперативной памяти занятой в процентах и мегабайтах. Так же выводит информацию о файле подкачки , кэшированной памяти, буфера и иную информацию о состоянии памяти.
#### Вывод и интерактивном режиме:
<ul>
 <li>Размеры памяти и подкачки</li>
    <ul>
      <li>PageSize: Размер страницы памяти
       <li>RAM-Memory (Оперативная память)            
      <li>Swap-Space (Пространство подкачки).
      <li>High-Memory и Low-Memory
        </li>
    </ul>
  </li>
 <li>Свободная память
   <ul>
      <li>Free (Свободно)
       <li>Free Percent (Процент свободы)          
        </li>
    </ul>
  </li>
  <li>Внутренняя память ядра Linux
   <ul>
      <li>Cached (Кэш)
       <li>Active (Активная)   
        <li>Buffers (Буферы)
       <li>Swapcached (Кэшировано в подкачке)  
       <li>Inactive (Неактивная) 
        </li>
    </ul>
  </li>
  <li>Дополнительная информация о памяти
   <ul>
      <li>Dirty (Грязная)
       <li>Writeback (Возвращаемая) 
        <li>Mapped (Отображенная)
       <li>Slab (Slab Allocator)
       <li>Commit_AS
         <li>PageTables (Таблицы страниц)
        </li>
    </ul>
  </li>
  
### Disks (d)
#### Вывод в режиме записи:
- DISKBUSY
 Процент времени, в течение которого диск активен.
- DISKREAD
Общее количество операций чтения с диска в КБ в секунду.
- DISKWRITE
Общее количество операций записи на диск в КБ в секунду.
- DISKXFER
Количество трансферов в секунду.
- DISKBSIZE 
Отображает информацию по состоянию жестких дисков и их разделов. Присутствует информация о суммарной скорости чтении и записи и все представлено в виде таблицы и графика.
#### Вывод в интерактивном режиме:
-	DiskName
-	Busy (%)
-	Read (Чтение KB/s)
-	Write (Запись KB/s)
-	Totals Read-MB/s
-	Writes-MB/s
-	Transfers/sec
### Kernel (k)
#### Вывод в режиме записи:
- Runnable
Число работоспособных процессов, готовых к запуску в секунду в runочереди. Очередь runподдерживается планировщиком процессов и содержит список потоков, готовых к отправке.
- Swap-in
Длина очереди swapв секунду, что означает количество готовых процессов, ожидающих выгрузки в секунду. Очередь подкачки содержит список процессов, которые готовы к запуску, но заменены запущенными в данный момент процессами.
- Pswitch
Количество переключений контекста процесса в секунду.
- Fork
Количество forkсистемных вызовов, выполняемых в секунду.
### VM
#### Вывод в режиме записи:
- Paging and Virtual Memory
- nr_dirty
- nr_writeback
- nr_unstable
- nr_page_table_pages
- nr_mapped
- nr_slab_reclaimable
- pgpgin
- pgpgout
- pswpin
- pswpout
- pgfree
- pgactivate
- pgdeactivate
- pgfault
- pgmajfault
- pginodesteal
- slabs_scanned
- kswapd_steal
- kswapd_inodesteal
- pageoutrun
- allocstall
- pgrotated
- pgalloc_high
- pgalloc_normal
- pgalloc_dma
- pgrefill_high
- pgrefill_normal
- pgrefill_dma
- pgsteal_high
- pgsteal_normal
- pgsteal_dma
- pgscan_kswapd_high
- pgscan_kswapd_normal
- pgscan_kswapd_dma-
- pgscan_direct_high
- pgscan_direct_normal
- pgscan_direct_dma
### Filesystems (j)
Выводит информацию о файловой системе в виде таблицы.(etc/mtab)
### Network (n)
#### Вывод в режиме записи:
- NET,Network I/O, [имя устройства], lo-read-KB/s,eth0-read-KB/s,lo-write-KB/s,eth0-write-KB/s
- NETPACKET,Network Packets, [имя устройства], lo-read/s,eth0-read/s,lo-write/s,eth0-write/s
Здесь можно посмотреть информацию о сетевых интерфейсах, а так же о количестве и размеру отправленных и полученных пакетах. Так же отображает сетевые ошибки так же в таблице.NFS (N)
Отображает информацию о сетевой файловой системе.
### Top processes (t)
В виде таблицы отображает список процессов, по каждому процессу показывает количество занятой оперативной памяти и.т.д.
### Virtual memory (V)
Отображает информацию о виртуальной памяти и разделе подкачки.
### Verbose hints (v)
Показывает информацию о ресурсах в плане безопасности, степень предупреждения и опасности в процентах.
### CPU long-term (l)
Позволяет на наглядном графике посмотреть загруженность процессора.
### Сбор данных
Добавление ключа -f переводит nmon в режим сбора данных
Мы можем задать частоту обновления сбора данных: -s [кол-во секунд]
 и количество требуемых снимков: -c [кол-во снимков]
На выходе получится файл с расширение .nmon, который можно удобно проанализировать утилитой nmonchart, которая создаст из него веб-страницу удобную для анализа полученных данных.
Для автоматизации сбора данных можно использовать cron. Задаем туда вызов nmon и через crontab задаем время вызова скрипта sh.
 

